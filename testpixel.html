<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pixel Scroll Transition Test</title>

  <!-- GSAP + ScrollTrigger -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      overflow-x: hidden;
      font-family: sans-serif;
    }

    section {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      transition: background 0.5s ease;
    }

    #section1 { background: black; color: white; }
    #section2 { background: white; color: black; }

    /* Pixel overlay */
    .pixel-mask {
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: black;
      z-index: 10;
      /* Create pixel-like chunks using CSS pattern */
      background-image: radial-gradient(square, black 50%, transparent 51%);
      background-size: 4px 4px;
      transform: scale(1);
      opacity: 0;
    }
  </style>
</head>
<body>

  <section id="section1">
    <h1>Section 1 — Black</h1>
  </section>

  <section id="section2">
    <h1>Section 2 — White</h1>
  </section>

  <div class="pixel-mask"></div>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    const mask = document.querySelector(".pixel-mask");

    // Create timeline for pixel transition
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: "#section2",
        start: "top bottom",     // when white section starts to enter
        end: "top top",          // until it fully replaces black
        scrub: true,
      }
    });

    // Animate mask "revealing" the next section
    tl.fromTo(mask,
      { opacity: 1, scale: 0.5 },
      { opacity: 0, scale: 3, ease: "power1.inOut" }
    );

    // Reverse effect when scrolling up
    ScrollTrigger.create({
      trigger: "#section2",
      start: "bottom bottom",
      end: "bottom top",
      scrub: true,
      onUpdate: (self) => {
        const progress = 1 - self.progress;
        gsap.to(mask, { opacity: progress, scale: 3 - 2.5 * progress, overwrite: true });
      }
    });
  </script>

</body>
</html>
